import contentList from "@industrial-media/common/graphql/fragments/content-list";
import { get } from "@mindful-web/object-path";

$ const { website, config, req } = out.global;
$ const { newsletter, date, dateInfo } = input;
$ const primaryColor = "#45ad35";
$ const nativeX = config.getAsObject("nativeX");

$ const { query } = req;
$ const mindful = query.mindful && query.mindful === "false" ? false : true;

<marko-newsletter-root
  title=newsletter.name
  description=newsletter.description
  date=date
>
  <@head>
    <common-static-styles />
  </@head>
  <@body style="margin: 0px !important;">
    <marko-newsletter-stealth-link newsletter=newsletter date=date />
    <tenant-banner-element
      newsletter=newsletter
      date=date
      date-info=dateInfo
    />

    <!-- Header -->
    <common-default-header-block
      name=newsletter.name
      href=website.get("origin")
      image-src="/files/base/indm/ien/image/2020/03/ist_header.5e617321bb8b9.png"
      bg-color="#ffffff"
    >
      <@wrapper date=date separator-type="date"/>
    </common-default-header-block>

    <!-- Content -->
    <common-featured-full-block
      section-id=88765,
      limit=1,
      title="FEATURED STORY",
      date=date,
      newsletter=newsletter,
      primary-color=primaryColor,
      hr-below=true,
    />

    <common-table width="630" style="border-collapse:collapse;" align="center" class="main" padding=0 spacing=0>
      <tr>
        <td>
          <common-featured-half-block
            section-id=88764,
            limit=2,
            date=date,
            newsletter=newsletter,
            primary-color=primaryColor,
            align="left",
          />
          <common-ad-wrapper-block
            newsletter=newsletter
            date=date
            primary-color=primaryColor
            promotion-component="half-native-block"
            placement-id=get(nativeX, `placements.${newsletter.alias}.toc-1`)
          />
          <common-ad-wrapper-block
            newsletter=newsletter
            date=date
            primary-color=primaryColor
            promotion-component="half-native-block"
            placement-id=get(nativeX, `placements.${newsletter.alias}.toc-2`)
          />
        </td>
      </tr>
    </common-table>

    <if(nativeX && mindful)>
      <common-newsletter-data
        newsletter=newsletter
        date=date
        primary-color=primaryColor
        section-name=input.sectionName
      />
    </if>
    <else>
      <common-feed-full-block
        section-id=88767,
        date=date,
        newsletter=newsletter,
        primary-color=primaryColor,
        limit=2,
      />
      <common-ad-wrapper-block
        newsletter=newsletter
        date=date
        primary-color=primaryColor
        promotion-component="full-native-block"
        placement-id=get(nativeX, `placements.${newsletter.alias}.inline-1`)
      />
      <common-feed-full-block
        section-id=88767,
        date=date,
        newsletter=newsletter,
        primary-color=primaryColor,
        limit=2,
        skip=2
      />
      <common-ad-wrapper-block
        newsletter=newsletter
        date=date
        primary-color=primaryColor
        promotion-component="full-native-block"
        placement-id=get(nativeX, `placements.${newsletter.alias}.inline-2`)
      />
      <common-feed-full-block
        section-id=88767,
        date=date,
        newsletter=newsletter,
        primary-color=primaryColor,
        limit=2,
        skip=4
      />
      <common-ad-wrapper-block
        newsletter=newsletter
        date=date
        primary-color=primaryColor
        promotion-component="full-native-block"
        placement-id=get(nativeX, `placements.${newsletter.alias}.inline-3`)
      />
      <common-feed-full-block
        section-id=88767,
        date=date,
        newsletter=newsletter,
        primary-color=primaryColor,
        limit=2,
        skip=6
      />
      <common-ad-wrapper-block
        newsletter=newsletter
        date=date
        primary-color=primaryColor
        promotion-component="full-native-block"
        placement-id=get(nativeX, `placements.${newsletter.alias}.inline-4`)
      />
      <common-feed-full-block
        section-id=88767,
        date=date,
        newsletter=newsletter,
        primary-color=primaryColor,
        limit=2,
        skip=8
      />
      <common-ad-wrapper-block
        newsletter=newsletter
        date=date
        primary-color=primaryColor
        promotion-component="full-native-block"
        placement-id=get(nativeX, `placements.${newsletter.alias}.inline-5`)
      />
      <common-feed-full-block
        section-id=88767,
        date=date,
        newsletter=newsletter,
        primary-color=primaryColor,
        skip=10
      />
    </else>

    <common-featured-full-block
      section-id=88766,
      limit=1,
      title="FEATURED VIDEO",
      date=date,
      newsletter=newsletter,
      primary-color=primaryColor,
      hr-below=true,
    />

    <!-- Footer/OptOut -->
    <common-default-footer-block advertise-page-link="https://www.ien.com/formstack/advertise_with_im_ien" />

  </@body>
</marko-newsletter-root>
